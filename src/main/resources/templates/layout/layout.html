<!doctype html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head th:replace="~{fragments/head :: commonHead(~{::title})}">
</head>

<body class="sidebar-fixed sidebar-expand-lg">

  <!-- 사이드바 -->
  <!-- ★ NEW: SSR FOUC 방지를 위해 기본 클래스도 넣어둠(라이트 기본) -->
  <aside id="sidebar" class="sidebar sidebar-light sidebar-fixed"
         th:replace="~{fragments/sidebar :: sidebar('sidebar-light')}">
  </aside>

  <!-- 본문 -->
  <div class="wrapper d-flex flex-column min-vh-100">

    <!-- 헤더 -->
    <header class="header header-sticky mb-4">
      <div class="container-fluid d-flex align-items-center justify-content-between">
        <button class="header-toggler px-md-0 me-3" type="button" id="sidebarToggleBtn"
                aria-label="Toggle sidebar" aria-controls="sidebar">
          <svg class="icon"><use th:href="@{/vendors/@coreui/icons/svg/free.svg#cil-menu}"></use></svg>
        </button>

        <!-- 우측 사용자 표기 - 로그아웃은 사이드바 아래로 옮김 -->
        <div class="d-flex align-items-center gap-2">
          <img th:src="@{/assets/img/avatars/3.jpg}"
               alt="avatar" class="rounded-circle"
               style="width:28px;height:28px;object-fit:cover;">
          <span class="small" th:text="${#authentication?.name} ?: '사용자'">사용자</span>
        </div>
      </div>

      <div class="header-divider"></div>
      <div class="container-fluid">
        <ol class="breadcrumb my-0 ms-2">
          <li class="breadcrumb-item"><a th:href="@{/home}">Home</a></li>
          <li class="breadcrumb-item active" th:text="${breadcrumb} ?: 'Dashboard'">Dashboard</li>
        </ol>
      </div>
    </header>

    <!-- 메인 -->
    <main class="body flex-grow-1 px-3">
      <div class="container-fluid">
        <section layout:fragment="content"></section>
      </div>
    </main>

    <!-- 푸터 -->
    <footer class="footer">
      <div class="ms-auto">© TheDream</div>
      <div class="ms-3">Built with CoreUI + Spring Boot</div>
    </footer>
  </div>


<th:block th:replace="~{fragments/scripts :: commonJs}"></th:block>
</body>
</html>
